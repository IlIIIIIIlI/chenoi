<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AMEX &#8212; Chenoi AI Lab</title>

    <!-- Loaded before other Sphinx assets -->
    <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
    <link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">


    <link rel="stylesheet" href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
    <link rel="preload" as="font" type="font/woff2" crossorigin
        href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
    <link rel="preload" as="font" type="font/woff2" crossorigin
        href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet"
        href="../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9"
        type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />

    <!-- Pre-loaded scripts that we'll load fully later -->
    <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script kind="utterances">

        var commentsRunWhenDOMLoaded = cb => {
            if (document.readyState != 'loading') {
                cb()
            } else if (document.addEventListener) {
                document.addEventListener('DOMContentLoaded', cb)
            } else {
                document.attachEvent('onreadystatechange', function () {
                    if (document.readyState == 'complete') cb()
                })
            }
        }

        var addUtterances = () => {
            var script = document.createElement("script");
            script.type = "text/javascript";
            script.src = "https://utteranc.es/client.js";
            script.async = "async";

            script.setAttribute("repo", "iliiiiiili/chenoi");
            script.setAttribute("issue-term", "title");
            script.setAttribute("theme", "boxy-light");
            script.setAttribute("label", "✨💬✨");
            script.setAttribute("crossorigin", "anonymous");

            sections = document.querySelectorAll("div.section");
            if (sections !== null) {
                section = sections[sections.length - 1];
                section.appendChild(script);
            }
        }
        commentsRunWhenDOMLoaded(addUtterances);
    </script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output, .cell_output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="个贷违约" href="%E4%B8%AA%E8%B4%B7%E8%BF%9D%E7%BA%A6%E9%A2%84%E6%B5%8B.html" />
    <link rel="prev" title="GPU云计算平台" href="%E4%BA%91%E8%AE%A1%E7%AE%97.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">


    <!-- Google Analytics -->

    <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-X7Q6P8J04K"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'G-X7Q6P8J04K');
    </script>

</head>

<body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
    <!-- Checkboxes to toggle the left sidebar -->
    <input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation"
        aria-label="Toggle navigation sidebar">
    <label class="overlay overlay-navbar" for="__navigation">
        <div class="visually-hidden">Toggle navigation sidebar</div>
    </label>
    <!-- Checkboxes to toggle the in-page toc -->
    <input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc"
        aria-label="Toggle in-page Table of Contents">
    <label class="overlay overlay-pagetoc" for="__page-toc">
        <div class="visually-hidden">Toggle in-page Table of Contents</div>
    </label>
    <!-- Headers at the top -->
    <div class="announcement header-item noprint">Welcome to chenoiAI Lab</div>
    <div class="header header-item noprint"></div>


    <div class="container-fluid" id="banner"></div>



    <div class="container-xl">
        <div class="row">

            <!-- Sidebar -->
            <div class="bd-sidebar noprint" id="site-navigation">
                <div class="bd-sidebar__content">
                    <div class="bd-sidebar__top">
                        <div class="navbar-brand-box">
                            <a class="navbar-brand text-wrap" href="../../index.html">

                                <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->



                                <img src="../../_static/logo.jpg" class="logo" alt="logo">


                                <h1 class="site-logo" id="site-title">Chenoi AI Lab</h1>

                            </a>
                        </div>
                        <form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
                            <i class="icon fas fa-search"></i>
                            <input type="search" class="form-control" name="q" id="search-input"
                                placeholder="Search this book..." aria-label="Search this book..." autocomplete="off">
                        </form>
                        <nav class="bd-links" id="bd-docs-nav" aria-label="Main">
                            <div class="bd-toc-item active">

                                <ul class="nav bd-sidenav bd-sidenav__home-link">
                                    <li class="toctree-l1">
                                        <a class="reference internal" href="../../intro.html">
                                            本书简介 - ChenoiLab Coding Book
                                        </a>
                                    </li>
                                </ul>
                                <p aria-level="2" class="caption" role="heading">
                                    <span class="caption-text">
                                        人工智障 - Artificial Intelligence
                                    </span>
                                </p>
                                <ul class="nav bd-sidenav">
                                    <li class="toctree-l1 has-children">
                                        <a class="reference internal" href="../RF/RF_intro.html">
                                            强化学习 - REINFORCEMENT LEARNING
                                        </a>
                                        <input class="toctree-checkbox" id="toctree-checkbox-1"
                                            name="toctree-checkbox-1" type="checkbox" />
                                        <label for="toctree-checkbox-1">
                                            <i class="fas fa-chevron-down">
                                            </i>
                                        </label>
                                        <ul>
                                            <li class="toctree-l2">
                                                <a class="reference internal" href="../RF/Q_learning.html">
                                                    Q-learning
                                                </a>
                                            </li>
                                        </ul>
                                    </li>
                                </ul>
                                <p aria-level="2" class="caption" role="heading">
                                    <span class="caption-text">
                                        语言 - Programming Language
                                    </span>
                                </p>
                                <ul class="nav bd-sidenav">
                                    <li class="toctree-l1 has-children">
                                        <a class="reference internal" href="../../Programming/programming_intro.html">
                                            学编程语言，就要学JAVA和C++
                                        </a>
                                        <input class="toctree-checkbox" id="toctree-checkbox-2"
                                            name="toctree-checkbox-2" type="checkbox" />
                                        <label for="toctree-checkbox-2">
                                            <i class="fas fa-chevron-down">
                                            </i>
                                        </label>
                                        <ul>
                                            <li class="toctree-l2">
                                                <a class="reference internal"
                                                    href="../../Programming/JAVA/90041_1.html">
                                                    Basic JAVA
                                                </a>
                                            </li>
                                        </ul>
                                    </li>
                                </ul>
                                <p aria-level="2" class="caption" role="heading">
                                    <span class="caption-text">
                                        趣库 - Interesting staffs
                                    </span>
                                </p>
                                <ul class="current nav bd-sidenav">
                                    <li class="toctree-l1 current active has-children">
                                        <a class="reference internal" href="AI_competition_intro.html">
                                            打比赛，一些网站的项目
                                        </a>
                                        <input checked="" class="toctree-checkbox" id="toctree-checkbox-3"
                                            name="toctree-checkbox-3" type="checkbox" />
                                        <label for="toctree-checkbox-3">
                                            <i class="fas fa-chevron-down">
                                            </i>
                                        </label>
                                        <ul class="current">
                                            <li class="toctree-l2">
                                                <a class="reference internal" href="%E4%BA%91%E8%AE%A1%E7%AE%97.html">
                                                    GPU云计算平台
                                                </a>
                                            </li>
                                            <li class="toctree-l2 current active">
                                                <a class="current reference internal" href="#">
                                                    AMEX
                                                </a>
                                            </li>
                                            <li class="toctree-l2">
                                                <a class="reference internal"
                                                    href="%E4%B8%AA%E8%B4%B7%E8%BF%9D%E7%BA%A6%E9%A2%84%E6%B5%8B.html">
                                                    个贷违约
                                                </a>
                                            </li>
                                            <li class="toctree-l2">
                                                <a class="reference internal"
                                                    href="%E9%93%B6%E8%A1%8C%E6%AC%BA%E8%AF%88%E6%A3%80%E6%B5%8B%E6%AF%94%E8%B5%9B.html">
                                                    银行欺诈检测比赛
                                                </a>
                                            </li>
                                            <li class="toctree-l2">
                                                <a class="reference internal"
                                                    href="%E4%BA%A7%E5%93%81%E8%AF%84%E8%AE%BA%E8%A7%82%E7%82%B9%E6%8F%90%E5%8F%96.html">
                                                    产品观点提取
                                                </a>
                                            </li>
                                        </ul>
                                    </li>
                                    <li class="toctree-l1 has-children">
                                        <a class="reference internal" href="../i/i_intro.html">
                                            每日都要锻炼君的
                                        </a>
                                        <input class="toctree-checkbox" id="toctree-checkbox-4"
                                            name="toctree-checkbox-4" type="checkbox" />
                                        <label for="toctree-checkbox-4">
                                            <i class="fas fa-chevron-down">
                                            </i>
                                        </label>
                                        <ul>
                                            <li class="toctree-l2">
                                                <a class="reference internal" href="../i/mental_cal.html">
                                                    practice mental calculation
                                                </a>
                                            </li>
                                        </ul>
                                    </li>
                                </ul>

                            </div>
                        </nav>
                    </div>
                    <div class="bd-sidebar__bottom">
                        <!-- To handle the deprecated key -->



                    </div>
                </div>
                <div id="rtd-footer-container"></div>
            </div>






            <!-- A tiny helper pixel to detect if we've scrolled -->
            <div class="sbt-scroll-pixel-helper"></div>
            <!-- Main content -->
            <div class="col py-0 content-container">

                <div class="header-article row sticky-top noprint">




                    <div class="col py-1 d-flex header-article-main">
                        <div class="header-article__left">

                            <label for="__navigation" class="headerbtn" data-toggle="tooltip" data-placement="right"
                                title="Toggle navigation">


                                <span class="headerbtn__icon-container">
                                    <i class="fas fa-bars"></i>
                                </span>

                            </label>


                        </div>
                        <div class="header-article__right">
                            <div class="menu-dropdown menu-dropdown-launch-buttons">
                                <button class="headerbtn menu-dropdown__trigger"
                                    aria-label="Launch interactive content">
                                    <i class="fas fa-rocket"></i>
                                </button>
                                <div class="menu-dropdown__content">
                                    <ul>
                                        <li>
                                            <a href="https://mybinder.org/v2/gh/iliiiiiili/chenoi/gh-pages/?urlpath=tree/AI/AI_competition/AMEXnote.ipynb"
                                                class="headerbtn" data-toggle="tooltip" data-placement="left"
                                                title="Launch on Binder">


                                                <span class="headerbtn__icon-container">

                                                    <img src="../../_static/images/logo_binder.svg">
                                                </span>
                                                <span class="headerbtn__text-container">Binder</span>
                                            </a>

                                        </li>

                                        <li>

                                            <button onclick="initThebeSBT()" class="headerbtn headerbtn-launch-thebe"
                                                data-toggle="tooltip" data-placement="left" title="Launch Thebe">


                                                <span class="headerbtn__icon-container">
                                                    <i class="fas fa-play"></i>
                                                </span>
                                                <span class="headerbtn__text-container">Live Code</span>
                                            </button>

                                        </li>

                                    </ul>
                                </div>
                            </div>

                            <button onclick="toggleFullScreen()" class="headerbtn" data-toggle="tooltip"
                                data-placement="bottom" title="Fullscreen mode">


                                <span class="headerbtn__icon-container">
                                    <i class="fas fa-expand"></i>
                                </span>

                            </button>

                            <div class="menu-dropdown menu-dropdown-download-buttons">
                                <button class="headerbtn menu-dropdown__trigger" aria-label="Download this page">
                                    <i class="fas fa-download"></i>
                                </button>
                                <div class="menu-dropdown__content">
                                    <ul>
                                        <li>
                                            <a href="../../_sources/AI/AI_competition/AMEXnote.ipynb" class="headerbtn"
                                                data-toggle="tooltip" data-placement="left"
                                                title="Download source file">


                                                <span class="headerbtn__icon-container">
                                                    <i class="fas fa-file"></i>
                                                </span>
                                                <span class="headerbtn__text-container">.ipynb</span>
                                            </a>

                                        </li>

                                        <li>

                                            <button onclick="printPdf(this)" class="headerbtn" data-toggle="tooltip"
                                                data-placement="left" title="Print to PDF">


                                                <span class="headerbtn__icon-container">
                                                    <i class="fas fa-file-pdf"></i>
                                                </span>
                                                <span class="headerbtn__text-container">.pdf</span>
                                            </button>

                                        </li>

                                    </ul>
                                </div>
                            </div>
                            <label for="__page-toc" class="headerbtn headerbtn-page-toc">


                                <span class="headerbtn__icon-container">
                                    <i class="fas fa-list"></i>
                                </span>

                            </label>

                        </div>
                    </div>

                    <!-- Table of contents -->
                    <div class="col-md-3 bd-toc show noprint">
                        <div class="tocsection onthispage pt-5 pb-3">
                            <i class="fas fa-list"></i> Contents
                        </div>
                        <nav id="bd-toc-nav" aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
                                <li class="toc-h1 nav-item toc-entry">
                                    <a class="reference internal nav-link" href="#">
                                        AMEX
                                    </a>
                                </li>
                                <li class="toc-h1 nav-item toc-entry">
                                    <a class="reference internal nav-link" href="#id2">
                                        基操
                                    </a>
                                    <ul class="visible nav section-nav flex-column">
                                        <li class="toc-h2 nav-item toc-entry">
                                            <a class="reference internal nav-link" href="#id3">
                                                合并数据
                                            </a>
                                        </li>
                                        <li class="toc-h2 nav-item toc-entry">
                                            <a class="reference internal nav-link" href="#id4">
                                                缺失值可视化
                                            </a>
                                        </li>
                                        <li class="toc-h2 nav-item toc-entry">
                                            <a class="reference internal nav-link" href="#labelbalance">
                                                label数据分布是否balance
                                            </a>
                                        </li>
                                    </ul>
                                </li>
                                <li class="toc-h1 nav-item toc-entry">
                                    <a class="reference internal nav-link" href="#eda">
                                        数据EDA方法
                                    </a>
                                    <ul class="visible nav section-nav flex-column">
                                        <li class="toc-h2 nav-item toc-entry">
                                            <a class="reference internal nav-link" href="#id5">
                                                对于这种结构化数据比赛，第一步可以看看有哪些列。
                                            </a>
                                        </li>
                                        <li class="toc-h2 nav-item toc-entry">
                                            <a class="reference internal nav-link" href="#attributes">
                                                对于一些数值类型的attributes，我们可以看看具体的取值范围
                                            </a>
                                        </li>
                                        <li class="toc-h2 nav-item toc-entry">
                                            <a class="reference internal nav-link" href="#id6">
                                                特征之间的相关性
                                            </a>
                                        </li>
                                        <li class="toc-h2 nav-item toc-entry">
                                            <a class="reference internal nav-link" href="#group-by">
                                                对于group by的数据，看看分布
                                            </a>
                                        </li>
                                        <li class="toc-h2 nav-item toc-entry">
                                            <a class="reference internal nav-link" href="#seasonal-patterns">
                                                大量的特征有seasonal patterns时
                                            </a>
                                        </li>
                                        <li class="toc-h2 nav-item toc-entry">
                                            <a class="reference internal nav-link" href="#attribute">
                                                如果attribute名称可以找规律的话，看看分布
                                            </a>
                                            <ul class="nav section-nav flex-column">
                                                <li class="toc-h3 nav-item toc-entry">
                                                    <a class="reference internal nav-link" href="#labels">
                                                        针对此类特征的可视化（例如他们对应labels的分布）
                                                    </a>
                                                </li>
                                            </ul>
                                        </li>
                                        <li class="toc-h2 nav-item toc-entry">
                                            <a class="reference internal nav-link" href="#catlabels">
                                                针对cat特征对应labels的可视化
                                            </a>
                                        </li>
                                        <li class="toc-h2 nav-item toc-entry">
                                            <a class="reference internal nav-link" href="#id9">
                                                时序可视化
                                            </a>
                                        </li>
                                    </ul>
                                </li>
                                <li class="toc-h1 nav-item toc-entry">
                                    <a class="reference internal nav-link" href="#id11">
                                        特征工程
                                    </a>
                                    <ul class="visible nav section-nav flex-column">
                                        <li class="toc-h2 nav-item toc-entry">
                                            <a class="reference internal nav-link" href="#id12">
                                                针对时序数据的特征工程
                                            </a>
                                        </li>
                                    </ul>
                                </li>
                                <li class="toc-h1 nav-item toc-entry">
                                    <a class="reference internal nav-link" href="#id14">
                                        训练
                                    </a>
                                </li>
                            </ul>

                        </nav>
                    </div>
                </div>
                <div class="article row">
                    <div class="col pl-md-3 pl-lg-5 content-container">
                        <!-- Table of contents that is only displayed when printing the page -->
                        <div id="jb-print-docs-body" class="onlyprint">
                            <h1>AMEX</h1>
                            <!-- Table of contents -->
                            <div id="print-main-content">
                                <div id="jb-print-toc">

                                    <div>
                                        <h2> Contents </h2>
                                    </div>
                                    <nav aria-label="Page">
                                        <ul class="visible nav section-nav flex-column">
                                            <li class="toc-h1 nav-item toc-entry">
                                                <a class="reference internal nav-link" href="#">
                                                    AMEX
                                                </a>
                                            </li>
                                            <li class="toc-h1 nav-item toc-entry">
                                                <a class="reference internal nav-link" href="#id2">
                                                    基操
                                                </a>
                                                <ul class="visible nav section-nav flex-column">
                                                    <li class="toc-h2 nav-item toc-entry">
                                                        <a class="reference internal nav-link" href="#id3">
                                                            合并数据
                                                        </a>
                                                    </li>
                                                    <li class="toc-h2 nav-item toc-entry">
                                                        <a class="reference internal nav-link" href="#id4">
                                                            缺失值可视化
                                                        </a>
                                                    </li>
                                                    <li class="toc-h2 nav-item toc-entry">
                                                        <a class="reference internal nav-link" href="#labelbalance">
                                                            label数据分布是否balance
                                                        </a>
                                                    </li>
                                                </ul>
                                            </li>
                                            <li class="toc-h1 nav-item toc-entry">
                                                <a class="reference internal nav-link" href="#eda">
                                                    数据EDA方法
                                                </a>
                                                <ul class="visible nav section-nav flex-column">
                                                    <li class="toc-h2 nav-item toc-entry">
                                                        <a class="reference internal nav-link" href="#id5">
                                                            对于这种结构化数据比赛，第一步可以看看有哪些列。
                                                        </a>
                                                    </li>
                                                    <li class="toc-h2 nav-item toc-entry">
                                                        <a class="reference internal nav-link" href="#attributes">
                                                            对于一些数值类型的attributes，我们可以看看具体的取值范围
                                                        </a>
                                                    </li>
                                                    <li class="toc-h2 nav-item toc-entry">
                                                        <a class="reference internal nav-link" href="#id6">
                                                            特征之间的相关性
                                                        </a>
                                                    </li>
                                                    <li class="toc-h2 nav-item toc-entry">
                                                        <a class="reference internal nav-link" href="#group-by">
                                                            对于group by的数据，看看分布
                                                        </a>
                                                    </li>
                                                    <li class="toc-h2 nav-item toc-entry">
                                                        <a class="reference internal nav-link"
                                                            href="#seasonal-patterns">
                                                            大量的特征有seasonal patterns时
                                                        </a>
                                                    </li>
                                                    <li class="toc-h2 nav-item toc-entry">
                                                        <a class="reference internal nav-link" href="#attribute">
                                                            如果attribute名称可以找规律的话，看看分布
                                                        </a>
                                                        <ul class="nav section-nav flex-column">
                                                            <li class="toc-h3 nav-item toc-entry">
                                                                <a class="reference internal nav-link" href="#labels">
                                                                    针对此类特征的可视化（例如他们对应labels的分布）
                                                                </a>
                                                            </li>
                                                        </ul>
                                                    </li>
                                                    <li class="toc-h2 nav-item toc-entry">
                                                        <a class="reference internal nav-link" href="#catlabels">
                                                            针对cat特征对应labels的可视化
                                                        </a>
                                                    </li>
                                                    <li class="toc-h2 nav-item toc-entry">
                                                        <a class="reference internal nav-link" href="#id9">
                                                            时序可视化
                                                        </a>
                                                    </li>
                                                </ul>
                                            </li>
                                            <li class="toc-h1 nav-item toc-entry">
                                                <a class="reference internal nav-link" href="#id11">
                                                    特征工程
                                                </a>
                                                <ul class="visible nav section-nav flex-column">
                                                    <li class="toc-h2 nav-item toc-entry">
                                                        <a class="reference internal nav-link" href="#id12">
                                                            针对时序数据的特征工程
                                                        </a>
                                                    </li>
                                                </ul>
                                            </li>
                                            <li class="toc-h1 nav-item toc-entry">
                                                <a class="reference internal nav-link" href="#id14">
                                                    训练
                                                </a>
                                            </li>
                                        </ul>

                                    </nav>
                                </div>
                            </div>
                        </div>
                        <main id="main-content" role="main">

                            <div>

                                <div class="tex2jax_ignore mathjax_ignore section" id="amex">
                                    <span id="id1"></span>
                                    <h1>AMEX<a class="headerlink" href="#amex" title="Permalink to this headline">#</a>
                                    </h1>
                                    <p>这是运通的信用卡违约预测大赛，方向是</p>
                                    <div class="highlight-default notranslate">
                                        <div class="highlight">
                                            <pre><span></span><span class="n">tabular</span> <span class="n">data</span>
</pre>
                                        </div>
                                    </div>
                                    <div class="highlight-default notranslate">
                                        <div class="highlight">
                                            <pre><span></span><span class="n">finance</span>
</pre>
                                        </div>
                                    </div>
                                    <div class="highlight-default notranslate">
                                        <div class="highlight">
                                            <pre><span></span><span class="n">binary</span> <span class="n">classification</span>
</pre>
                                        </div>
                                    </div>
                                    <div class="highlight-default notranslate">
                                        <div class="highlight">
                                            <pre><span></span><span class="n">custom</span> <span class="n">metric</span>
</pre>
                                        </div>
                                    </div>
                                </div>
                                <div class="tex2jax_ignore mathjax_ignore section" id="id2">
                                    <h1>基操<a class="headerlink" href="#id2" title="Permalink to this headline">#</a>
                                    </h1>
                                    <div class="section" id="id3">
                                        <h2>合并数据<a class="headerlink" href="#id3"
                                                title="Permalink to this headline">#</a></h2>
                                        <div class="cell docutils container">
                                            <div class="cell_input docutils container">
                                                <div class="highlight-ipython3 notranslate">
                                                    <div class="highlight">
                                                        <pre><span></span><span class="n">df_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="s2">&quot;../input/amex-data-integer-dtypes-parquet-format/train.parquet&quot;</span><span class="p">)</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../input/amex-default-prediction/train_labels.csv&#39;</span><span class="p">)</span>
<span class="n">df_train</span> <span class="o">=</span> <span class="n">df_train</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;customer_ID&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;customer_ID&#39;</span><span class="p">)</span>
</pre>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="section" id="id4">
                                        <h2>缺失值可视化<a class="headerlink" href="#id4"
                                                title="Permalink to this headline">#</a></h2>
                                        <div class="cell docutils container">
                                            <div class="cell_input docutils container">
                                                <div class="highlight-ipython3 notranslate">
                                                    <div class="highlight">
                                                        <pre><span></span><span class="n">null_vals</span> <span class="o">=</span> <span class="n">df_train</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">null_vals</span><span class="p">[</span><span class="n">null_vals</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Null value count&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Columns&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Count&quot;</span><span class="p">)</span>
<span class="n">null_vals</span><span class="p">[</span><span class="n">null_vals</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span><span class="p">);</span>
</pre>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="section" id="labelbalance">
                                        <h2>label数据分布是否balance<a class="headerlink" href="#labelbalance"
                                                title="Permalink to this headline">#</a></h2>
                                        <div class="cell docutils container">
                                            <div class="cell_input docutils container">
                                                <div class="highlight-ipython3 notranslate">
                                                    <div class="highlight">
                                                        <pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span>
    <span class="n">df_train</span><span class="p">[</span><span class="s2">&quot;target&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
<span class="p">)</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Target&quot;</span><span class="p">);</span>
</pre>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="tex2jax_ignore mathjax_ignore section" id="eda">
                                    <h1>数据EDA方法<a class="headerlink" href="#eda"
                                            title="Permalink to this headline">#</a></h1>
                                    <div class="section" id="id5">
                                        <h2>对于这种结构化数据比赛，第一步可以看看有哪些列。<a class="headerlink" href="#id5"
                                                title="Permalink to this headline">#</a></h2>
                                        <div class="cell docutils container">
                                            <div class="cell_input docutils container">
                                                <div class="highlight-ipython3 notranslate">
                                                    <div class="highlight">
                                                        <pre><span></span><span class="c1"># a sum view</span>
<span class="n">train_df</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="cell docutils container">
                                            <div class="cell_input docutils container">
                                                <div class="highlight-ipython3 notranslate">
                                                    <div class="highlight">
                                                        <pre><span></span><span class="c1"># a more detailed view</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">train_df</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">train_df</span><span class="o">.</span><span class="n">dtypes</span><span class="p">[</span><span class="n">train_df</span><span class="o">.</span><span class="n">dtypes</span> <span class="o">==</span> <span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">to_list</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="section" id="attributes">
                                        <h2>对于一些数值类型的attributes，我们可以看看具体的取值范围<a class="headerlink" href="#attributes"
                                                title="Permalink to this headline">#</a></h2>
                                        <div class="cell docutils container">
                                            <div class="cell_input docutils container">
                                                <div class="highlight-ipython3 notranslate">
                                                    <div class="highlight">
                                                        <pre><span></span><span class="n">desc_df</span> <span class="o">=</span> <span class="n">train_df</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">train_df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">desc_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;unique&#39;</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
<span class="n">desc_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;unique&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">desc_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;unique&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">desc_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;unique&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span>
</pre>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="section" id="id6">
                                        <h2><a class="reference external"
                                                href="https://www.kaggle.com/code/finlay/amex-correlation-and-time-series-eda/?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE2NTk5MzgxODYsImZpbGVHVUlEIjoiZUhuSWVmb0o2M1FtcnhuSSIsImlhdCI6MTY1OTkzNzg4NiwiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjotNjk4OTc5OTk2NH0.fLk_LRu13j1oIK9WDL3gMg3JMK_6kVXTD0wzzcaRGk4">特征之间的相关性</a><a
                                                class="headerlink" href="#id6" title="Permalink to this headline">#</a>
                                        </h2>
                                        <div class="admonition note">
                                            <p class="admonition-title">Note</p>
                                            <ol class="simple">
                                                <li>
                                                    <p>热力图不要只看某个pixel格子，而是要看特征成组的情况。</p>
                                                </li>
                                                <li>
                                                    <p>可以用corr_agg.loc[‘label’].abs().plot(kind=’bar’)来获得所有attributes和label之间的关系。
                                                    </p>
                                                    <ul class="simple">
                                                        <li>
                                                            <p>寻找周期性，来看主办方是否有特意按照某种模式储存</p>
                                                        </li>
                                                    </ul>
                                                </li>
                                            </ol>
                                        </div>
                                        <div class="cell docutils container">
                                            <div class="cell_input docutils container">
                                                <div class="highlight-ipython3 notranslate">
                                                    <div class="highlight">
                                                        <pre><span></span><span class="n">mean_agg</span> <span class="o">=</span> <span class="n">train_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;customer_ID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">corr_agg</span> <span class="o">=</span> <span class="n">mean_agg</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">corr_agg</span><span class="p">)</span>
</pre>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="cell docutils container">
                                            <div class="cell_input docutils container">
                                                <div class="highlight-ipython3 notranslate">
                                                    <div class="highlight">
                                                        <pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">corr_agg</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span>
</pre>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <img alt="../../_images/AMEX_3.png" id="label" src="../../_images/AMEX_3.png" />
                                    </div>
                                    <div class="section" id="group-by">
                                        <h2>对于group by的数据，看看分布<a class="headerlink" href="#group-by"
                                                title="Permalink to this headline">#</a></h2>
                                        <div class="cell docutils container">
                                            <div class="cell_input docutils container">
                                                <div class="highlight-ipython3 notranslate">
                                                    <div class="highlight">
                                                        <pre><span></span><span class="n">rand_customers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">df_train</span><span class="p">[</span><span class="s2">&quot;customer_ID&quot;</span><span class="p">])[:</span><span class="mi">100</span><span class="p">]</span> <span class="c1"># for 100 customers</span>
<span class="n">id_counts</span> <span class="o">=</span> <span class="n">df_train</span><span class="p">[</span><span class="n">df_train</span><span class="p">[</span><span class="s2">&quot;customer_ID&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">rand_customers</span><span class="p">)]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;customer_ID&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="s2">&quot;count&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">id_counts</span><span class="p">[</span><span class="s2">&quot;S_2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">);</span>
</pre>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="section" id="seasonal-patterns">
                                        <h2><a class="reference external"
                                                href="https://www.kaggle.com/code/pavelvod/amex-eda-revealing-time-patterns-of-features/notebook?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE2NTk5MzgxODYsImZpbGVHVUlEIjoiZUhuSWVmb0o2M1FtcnhuSSIsImlhdCI6MTY1OTkzNzg4NiwiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjotNjk4OTc5OTk2NH0.fLk_LRu13j1oIK9WDL3gMg3JMK_6kVXTD0wzzcaRGk4">大量的特征有seasonal
                                                patterns时</a><a class="headerlink" href="#seasonal-patterns"
                                                title="Permalink to this headline">#</a></h2>
                                        <p>这可能会在很多方面影响模型：比如数据漂移和对未见过的数据表现不好。另外，即使是简单的特征工程也可能不太准确–如果特征有稳定的正向趋势，那么最大值将更接近于最后一次付款。我们可以考虑在每日水平上对数据进行规范化，以避免这些错误。这也可能为特征提取打开额外的维度：例如，我们可以使用季节性或趋势特征作为额外的特征。
                                        </p>
                                        <p>计算每一天每个特征的平均值，从而得出每个特征的单变量时间序列。只有当最大的自相关成分超过阈值（0.6）时才绘制.</p>
                                        <div class="cell docutils container">
                                            <div class="cell_input docutils container">
                                                <div class="highlight-ipython3 notranslate">
                                                    <div class="highlight">
                                                        <pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.stattools</span> <span class="kn">import</span> <span class="n">acf</span><span class="p">,</span> <span class="n">pacf</span>
<span class="kn">from</span> <span class="nn">statsmodels.graphics.tsaplots</span> <span class="kn">import</span> <span class="n">plot_acf</span><span class="p">,</span> <span class="n">plot_pacf</span>
<span class="kn">import</span> <span class="nn">gc</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">os</span>
</pre>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="cell docutils container">
                                            <div class="cell_input docutils container">
                                                <div class="highlight-ipython3 notranslate">
                                                    <div class="highlight">
                                                        <pre><span></span><span class="n">train_agg</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="s1">&#39;../train.parquet&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">S_2</span><span class="o">=</span><span class="k">lambda</span> <span class="n">dx</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">dx</span><span class="o">.</span><span class="n">S_2</span><span class="p">))</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;S_2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">end_of_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">train_agg</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="n">test_agg</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">cols2use</span> <span class="ow">in</span> <span class="n">train_agg</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">47</span><span class="p">):</span>
    <span class="n">test_agg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="s1">&#39;../test.parquet&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">cols2use</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;S_2&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">S_2</span><span class="o">=</span><span class="k">lambda</span> <span class="n">dx</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">dx</span><span class="o">.</span><span class="n">S_2</span><span class="p">))</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;S_2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>


<span class="n">test_agg</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">test_agg</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">agg_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">train_agg</span><span class="p">,</span> <span class="n">test_agg</span><span class="p">])</span>
<span class="k">for</span> <span class="n">first_letter</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">col</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">agg_data</span><span class="o">.</span><span class="n">columns</span><span class="p">])):</span>
    <span class="k">break</span>
<span class="k">for</span> <span class="n">first_letter</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">col</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">agg_data</span><span class="o">.</span><span class="n">columns</span><span class="p">])):</span>
    <span class="k">for</span> <span class="n">feature_name</span> <span class="ow">in</span> <span class="n">agg_data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">feature_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">first_letter</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">agg_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">feature_name</span><span class="p">]</span>
        <span class="n">max_acf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">acf</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">nlags</span><span class="o">=</span><span class="n">agg_data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">max_acf</span> <span class="o">&gt;</span> <span class="mf">0.6</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">feature_name</span><span class="p">)</span> <span class="c1"># for Ctrl + F</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
            <span class="n">sub_pacf</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
            <span class="n">sub_acf</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> 
            <span class="n">mn</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> 
            <span class="n">plot_pacf</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="n">agg_data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">sub_acf</span><span class="p">)</span>
            <span class="n">plot_acf</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="n">agg_data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">size</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">sub_pacf</span><span class="p">)</span>
            <span class="n">s</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">mn</span><span class="p">)</span>
            <span class="n">mn</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">end_of_train</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
            <span class="n">mn</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">feature_name</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span> <span class="mf">0.25</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span> <span class="mf">0.25</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <img alt="../../_images/AMEX_5.png" id="id7" src="../../_images/AMEX_5.png" />
                                    </div>
                                    <div class="section" id="attribute">
                                        <h2>如果attribute名称可以找规律的话，看看分布<a class="headerlink" href="#attribute"
                                                title="Permalink to this headline">#</a></h2>
                                        <div class="cell docutils container">
                                            <div class="cell_input docutils container">
                                                <div class="highlight-ipython3 notranslate">
                                                    <div class="highlight">
                                                        <pre><span></span><span class="n">var_count</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df_train</span><span class="o">.</span><span class="n">columns</span> <span class="p">:</span>
    <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;S_&quot;</span><span class="p">):</span>
        <span class="n">var_count</span><span class="p">[</span><span class="s2">&quot;Spend variables&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">var_count</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Spend variables&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> 
    <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;D_&quot;</span><span class="p">):</span>
        <span class="n">var_count</span><span class="p">[</span><span class="s2">&quot;Deliquency variables&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">var_count</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Deliquency variables&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;B_&quot;</span><span class="p">):</span>
        <span class="n">var_count</span><span class="p">[</span><span class="s2">&quot;Balance variables&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">var_count</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Balance variables&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;R_&quot;</span><span class="p">):</span>
        <span class="n">var_count</span><span class="p">[</span><span class="s2">&quot;Risk variables&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">var_count</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Risk variables&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;P_&quot;</span><span class="p">):</span>
        <span class="n">var_count</span><span class="p">[</span><span class="s2">&quot;Payment variables&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">var_count</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Payment variables&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">var_count</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span> <span class="n">y</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">var_count</span><span class="o">.</span><span class="n">values</span><span class="p">()));</span>
</pre>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="section" id="labels">
                                            <h3><a class="reference external"
                                                    href="https://www.kaggle.com/code/pathikghugare/american-express-eda/notebook?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE2NTk5MzgxODYsImZpbGVHVUlEIjoiZUhuSWVmb0o2M1FtcnhuSSIsImlhdCI6MTY1OTkzNzg4NiwiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjotNjk4OTc5OTk2NH0.fLk_LRu13j1oIK9WDL3gMg3JMK_6kVXTD0wzzcaRGk4">针对此类特征的可视化（例如他们对应labels的分布）</a><a
                                                    class="headerlink" href="#labels"
                                                    title="Permalink to this headline">#</a></h3>
                                            <div class="cell docutils container">
                                                <div class="cell_input docutils container">
                                                    <div class="highlight-ipython3 notranslate">
                                                        <div class="highlight">
                                                            <pre><span></span><span class="n">payment_vars</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df_train</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;P_&quot;</span><span class="p">)]</span>
<span class="n">corr</span> <span class="o">=</span> <span class="n">df_train</span><span class="p">[</span><span class="n">payment_vars</span><span class="o">+</span><span class="p">[</span><span class="s2">&quot;target&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">corr</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Purples&quot;</span><span class="p">);</span>
</pre>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="cell docutils container">
                                                <div class="cell_input docutils container">
                                                    <div class="highlight-ipython3 notranslate">
                                                        <div class="highlight">
                                                            <pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">payment_vars</span><span class="p">)</span>  <span class="p">:</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">df_train</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">col</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Distribution of Payment Variables w.r.t target&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="section" id="catlabels">
                                        <h2>针对cat特征对应labels的可视化<a class="headerlink" href="#catlabels"
                                                title="Permalink to this headline">#</a></h2>
                                        <div class="cell docutils container">
                                            <div class="cell_input docutils container">
                                                <div class="highlight-ipython3 notranslate">
                                                    <div class="highlight">
                                                        <pre><span></span><span class="n">cat_features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;B_30&#39;</span><span class="p">,</span> <span class="s1">&#39;B_38&#39;</span><span class="p">,</span> <span class="s1">&#39;D_114&#39;</span><span class="p">,</span> <span class="s1">&#39;D_116&#39;</span><span class="p">,</span> <span class="s1">&#39;D_117&#39;</span><span class="p">,</span> <span class="s1">&#39;D_120&#39;</span><span class="p">,</span> <span class="s1">&#39;D_126&#39;</span><span class="p">,</span> <span class="s1">&#39;D_63&#39;</span><span class="p">,</span> <span class="s1">&#39;D_64&#39;</span><span class="p">,</span> <span class="s1">&#39;D_66&#39;</span><span class="p">,</span> <span class="s1">&#39;D_68&#39;</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cat_features</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="n">f</span><span class="p">][</span><span class="n">train</span><span class="o">.</span><span class="n">target</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;count&#39;</span><span class="p">))</span>
    <span class="n">temp</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;value&#39;</span>
    <span class="n">temp</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">temp</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">temp</span><span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;target=0&#39;</span><span class="p">)</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="n">f</span><span class="p">][</span><span class="n">train</span><span class="o">.</span><span class="n">target</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;count&#39;</span><span class="p">))</span>
    <span class="n">temp</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;value&#39;</span>
    <span class="n">temp</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">temp</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">temp</span><span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;target=1&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;frequency&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">temp</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">temp</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Categorical features&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.93</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="k">del</span> <span class="n">temp</span>
</pre>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <img alt="../../_images/AMEX_2.png" id="id8" src="../../_images/AMEX_2.png" />
                                    </div>
                                    <div class="section" id="id9">
                                        <h2><a class="reference external"
                                                href="https://www.kaggle.com/code/ambrosm/amex-eda-which-makes-sense">时序可视化</a><a
                                                class="headerlink" href="#id9" title="Permalink to this headline">#</a>
                                        </h2>
                                        <p>观察每种attribute的日期分布情况</p>
                                        <div class="cell docutils container">
                                            <div class="cell_input docutils container">
                                                <div class="highlight-ipython3 notranslate">
                                                    <div class="highlight">
                                                        <pre><span></span><span class="n">temp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">train</span><span class="p">[[</span><span class="s1">&#39;customer_ID&#39;</span><span class="p">,</span> <span class="s1">&#39;S_2&#39;</span><span class="p">]],</span> <span class="n">test</span><span class="p">[[</span><span class="s1">&#39;customer_ID&#39;</span><span class="p">,</span> <span class="s1">&#39;S_2&#39;</span><span class="p">]]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">temp</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;customer_ID&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">temp</span><span class="p">[</span><span class="s1">&#39;last_month&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;customer_ID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">S_2</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span>
<span class="n">last_month</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="s1">&#39;last_month&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">([</span><span class="n">temp</span><span class="o">.</span><span class="n">S_2</span><span class="p">[</span><span class="n">temp</span><span class="o">.</span><span class="n">last_month</span> <span class="o">==</span> <span class="mi">3</span><span class="p">],</span>   <span class="c1"># ending 03/18 -&gt; training</span>
          <span class="n">temp</span><span class="o">.</span><span class="n">S_2</span><span class="p">[</span><span class="n">temp</span><span class="o">.</span><span class="n">last_month</span> <span class="o">==</span> <span class="mi">4</span><span class="p">],</span>   <span class="c1"># ending 04/19 -&gt; public lb</span>
          <span class="n">temp</span><span class="o">.</span><span class="n">S_2</span><span class="p">[</span><span class="n">temp</span><span class="o">.</span><span class="n">last_month</span> <span class="o">==</span> <span class="mi">10</span><span class="p">]],</span> <span class="c1"># ending 10/19 -&gt; private lb</span>
         <span class="n">bins</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;2017-03-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2019-11-01&quot;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;MS&quot;</span><span class="p">),</span>
         <span class="n">label</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Training&#39;</span><span class="p">,</span> <span class="s1">&#39;Public leaderboard&#39;</span><span class="p">,</span> <span class="s1">&#39;Private leaderboard&#39;</span><span class="p">],</span>
         <span class="n">stacked</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;2017-03-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2019-11-01&quot;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;QS&quot;</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Statement date&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;The three datasets over time&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="cell docutils container">
                                            <div class="cell_input docutils container">
                                                <div class="highlight-ipython3 notranslate">
                                                    <div class="highlight">
                                                        <pre><span></span><span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="p">[</span> <span class="s1">&#39;B_29&#39;</span><span class="p">,</span> <span class="s1">&#39;S_9&#39;</span><span class="p">,</span><span class="s1">&#39;D_87&#39;</span><span class="p">]:</span><span class="c1">#, &#39;D_88&#39;, &#39;R_26&#39;, &#39;R_27&#39;, &#39;D_108&#39;, &#39;D_110&#39;, &#39;D_111&#39;, &#39;B_39&#39;, &#39;B_42&#39;]:</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">train</span><span class="p">[[</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;S_2&#39;</span><span class="p">]],</span> <span class="n">test</span><span class="p">[[</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;S_2&#39;</span><span class="p">]]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">temp</span><span class="p">[</span><span class="s1">&#39;last_month&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">last_month</span>
    <span class="n">temp</span><span class="p">[</span><span class="s1">&#39;has_f&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">~</span><span class="n">temp</span><span class="p">[</span><span class="n">f</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span> 

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">([</span><span class="n">temp</span><span class="o">.</span><span class="n">S_2</span><span class="p">[</span><span class="n">temp</span><span class="o">.</span><span class="n">has_f</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">temp</span><span class="o">.</span><span class="n">last_month</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)],</span>   <span class="c1"># ending 03/18 -&gt; training</span>
              <span class="n">temp</span><span class="o">.</span><span class="n">S_2</span><span class="p">[</span><span class="n">temp</span><span class="o">.</span><span class="n">has_f</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">temp</span><span class="o">.</span><span class="n">last_month</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)],</span>   <span class="c1"># ending 04/19 -&gt; public lb</span>
              <span class="n">temp</span><span class="o">.</span><span class="n">S_2</span><span class="p">[</span><span class="n">temp</span><span class="o">.</span><span class="n">has_f</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">temp</span><span class="o">.</span><span class="n">last_month</span> <span class="o">==</span> <span class="mi">10</span><span class="p">)]],</span> <span class="c1"># ending 10/19 -&gt; private lb</span>
             <span class="n">bins</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;2017-03-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2019-11-01&quot;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;MS&quot;</span><span class="p">),</span>
             <span class="n">label</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Training&#39;</span><span class="p">,</span> <span class="s1">&#39;Public leaderboard&#39;</span><span class="p">,</span> <span class="s1">&#39;Private leaderboard&#39;</span><span class="p">],</span>
             <span class="n">stacked</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;2017-03-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2019-11-01&quot;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;QS&quot;</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Statement date&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Count of </span><span class="si">{</span><span class="n">f</span><span class="si">}</span><span class="s1"> non-null values&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">f</span><span class="si">}</span><span class="s1"> non-null values over time&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <img alt="../../_images/AMEX_4.png" id="id10" src="../../_images/AMEX_4.png" />
                                    </div>
                                </div>
                                <div class="tex2jax_ignore mathjax_ignore section" id="id11">
                                    <h1>特征工程<a class="headerlink" href="#id11" title="Permalink to this headline">#</a>
                                    </h1>
                                    <div class="section" id="id12">
                                        <h2>针对时序数据的特征工程<a class="headerlink" href="#id12"
                                                title="Permalink to this headline">#</a></h2>
                                        <img alt="../../_images/AMEX_1.png" id="id13" src="../../_images/AMEX_1.png" />
                                        <ol class="simple">
                                            <li>
                                                <p>针对相同用户，对于numeric data（dense），我们可以提取moving average做分箱处理找到变化趋势。
                                                    对于cat data（Sparse），我们可以统计0和非0的频率，并赋值。</p>
                                            </li>
                                        </ol>
                                    </div>
                                </div>
                                <div class="tex2jax_ignore mathjax_ignore section" id="id14">
                                    <h1><a class="reference external"
                                            href="https://www.dropbox.com/sh/pydk3cuwmbbpeoi/AAAxNAmx7iDDphXPdEZrQjcfa?dl=0">训练</a><a
                                            class="headerlink" href="#id14" title="Permalink to this headline">#</a>
                                    </h1>
                                </div>

                                <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "iliiiiiili/chenoi",
            ref: "gh-pages/",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./AI/AI_competition"
        },
        predefinedOutput: true
    }
    </script>
                                <script>kernelName = 'python3'</script>

                            </div>

                        </main>
                        <footer class="footer-article noprint">

                            <!-- Previous / next buttons -->
                            <div class='prev-next-area'>
                                <a class='left-prev' id="prev-link" href="%E4%BA%91%E8%AE%A1%E7%AE%97.html"
                                    title="previous page">
                                    <i class="fas fa-angle-left"></i>
                                    <div class="prev-next-info">
                                        <p class="prev-next-subtitle">previous</p>
                                        <p class="prev-next-title">GPU云计算平台</p>
                                    </div>
                                </a>
                                <a class='right-next' id="next-link"
                                    href="%E4%B8%AA%E8%B4%B7%E8%BF%9D%E7%BA%A6%E9%A2%84%E6%B5%8B.html"
                                    title="next page">
                                    <div class="prev-next-info">
                                        <p class="prev-next-subtitle">next</p>
                                        <p class="prev-next-title">个贷违约</p>
                                    </div>
                                    <i class="fas fa-angle-right"></i>
                                </a>
                            </div>
                        </footer>
                    </div>
                </div>
                <div class="footer-content row">
                    <footer class="col footer">
                        <p>

                            By Quechen YANG, with thank to my GF Becky Yu<br />

                            &copy; Copyright 2022.<br />
                        </p>
                    </footer>
                </div>

            </div>


        </div>
    </div>

    <!-- Scripts loaded after <body> so the DOM is not blocked -->
    <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


</body>

</html>